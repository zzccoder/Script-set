<p>--======================================</p><p>--查询指定数据库最近一天的备份历史记录</p><p>SELECT</p><p>CONVERT(CHAR(100),SERVERPROPERTY(&#39;Servername&#39;))ASServer,</p><p>bs.database_name,</p><p>bs.backup_start_date,</p><p>bs.backup_finish_date,</p><p>bs.expiration_date,</p><p>CASE bs.type</p><p>WHEN &#39;D&#39; THEN &#39;Database&#39;</p><p>WHEN &#39;L&#39; THEN &#39;Log&#39;</p><p>END ASbackup_type,</p><p>bs.backup_size,</p><p>bmf.logical_device_name,</p><p>bmf.physical_device_name,&nbsp;</p><p>bs.name AS backupset_name,</p><p>bs.description</p><p>FROM msdb.dbo.backupmediafamily bmf</p><p>INNER JOIN msdb.dbo.backupset bs</p><p>ON bmf.media_set_id=bs.media_set_id</p><p>WHERE bs.database_name=&#39;databasename&#39;</p><p>AND bs.backup_start_date&gt;DATEADD(DAY,-1,GETDATE())</p><p>ORDER BY bs.database_name,</p><p>bs.backup_finish_date</p><p><br/></p><p><br/></p><p>--====================================================</p><p>--查看数据库备份的详细信息：时间存储地址最大/最小LSN</p><p>SELECT * FROM msdb.dbo.backupset AS BS</p><p>INNER JOIN msdb.dbo.backupfile AS BF</p><p>ON BF.backup_set_id=BS.backup_set_id</p><p>INNER JOIN msdb.dbo.backupmediaset AS BMS</p><p>ON BMS.media_set_id=BS.media_set_id</p><p>INNER JOIN msdb.dbo.backupmediafamily AS BMF</p><p>ON BMF.media_set_id=BMS.media_set_id</p><p>ORDER BY BS.backup_finish_date DESC</p><p><br/></p>