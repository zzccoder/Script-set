<p>--=====================================================</p><p>--查看执行计划类型和占用空间</p><p>SELECT &nbsp;cp.usecounts AS &#39;使用次数&#39; ,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; cp.cacheobjtype AS &#39;缓存类型&#39; ,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; cp.objtype AS [对象类型] ,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; st.text AS &#39;TSQL&#39; ,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; qp.query_plan AS &#39;执行计划&#39; ,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; cp.size_in_bytes AS &#39;执行计划占用空间(Byte)&#39;</p><p>FROM &nbsp; &nbsp;sys.dm_exec_cached_plans cp</p><p>&nbsp; &nbsp; &nbsp; &nbsp; CROSS APPLY sys.dm_exec_sql_text(plan_handle) st</p><p>&nbsp; &nbsp; &nbsp; &nbsp; CROSS APPLY sys.dm_exec_query_plan(plan_handle) qp</p><p>ORDER BY size_in_bytes DESC</p><p><br/></p><p><br/></p><p>SELECT &nbsp;cp.cacheobjtype AS &#39;缓存类型&#39; ,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; cp.objtype AS [对象类型] ,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; SUM(cp.size_in_bytes) / 1024 / 1024 AS &#39;执行计划占用空间(MB)&#39;,</p><p><span class="Apple-tab-span" style="white-space:pre">		</span>COUNT(1) AS PlanCount</p><p>FROM &nbsp; &nbsp;sys.dm_exec_cached_plans cp</p><p>GROUP BY cp.cacheobjtype ,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; cp.objtype</p><p><br/></p>