<p>--========================================================================</p><p>--使用XML来将字符串分隔成行数据 <span class="Apple-tab-span" style="white-space:pre">	</span></p><p>DECLARE @xml XML</p><p>SET @xml=CAST(REPLACE(&#39;&lt;ROOT&gt;&lt;X&gt;&#39;+&#39;AA,AB,AC,AD&#39;+&#39;&lt;/X&gt;&lt;/ROOT&gt;&#39;,&#39;,&#39;,&#39;&lt;/X&gt;&lt;X&gt;&#39;) AS XML)</p><p><br/></p><p>SELECT T.C.value(&#39;.&#39;,&#39;varchar(20)&#39;) AS Result FROM @xml.nodes(&#39;/ROOT/X&#39;) T(C)</p><p><br/></p><p>--==========================================================================</p><p>--去前几条记录，如&#39;10,102,10254,103265,541,2154,41,156&#39;中第四个&#39;,&#39;前的字符串</p><p><br/></p><p>DECLARE @sourceStr NVARCHAR(MAX)</p><p>DECLARE @splitStr NVARCHAR(10)</p><p>SET @sourceStr=&#39;10,102,10254,103265,541,2154,41,156&#39;</p><p>SET @splitStr=&#39;,&#39;</p><p>DECLARE @xml XML</p><p>SET @xml=CAST(REPLACE(&#39;&lt;ROOT&gt;&lt;X&gt;&#39;+@sourceStr+&#39;&lt;/X&gt;&lt;/ROOT&gt;&#39;,@splitStr,&#39;&lt;/X&gt;&lt;X&gt;&#39;) AS XML)</p><p><br/></p><p>SELECT TOP(3) Result+&#39;,&#39; AS [text()]</p><p>FROM&nbsp;</p><p>(</p><p>&nbsp;SELECT T.C.value(&#39;.&#39;,&#39;varchar(20)&#39;) AS Result&nbsp;</p><p>&nbsp;FROM @xml.nodes(&#39;/ROOT/X&#39;) T(C)</p><p>) AS T1&nbsp;</p><p>FOR XML PATH(&#39;&#39;)</p><p><br/></p>