<p>--=================================================</p><p>--摘抄自http://www.cnblogs.com/sunth/archive/2013/06/05/3118312.html</p><p>--用法:</p><p>--EXEC [dbo].[usp_GenInsertSQL] &#39;dbo.TB1&#39;</p><p>--=================================================</p><p>GO</p><p>SET ANSI_NULLS ON</p><p>GO</p><p><br/></p><p>SET QUOTED_IDENTIFIER ON</p><p>GO</p><p>create proc [dbo].[usp_GenInsertSQL]&nbsp;</p><p>&nbsp; @TableName as varchar(100)&nbsp;</p><p>&nbsp; as</p><p>&nbsp; DECLARE xCursor CURSOR FOR</p><p>&nbsp; SELECT name,xusertype&nbsp;</p><p>&nbsp; FROM syscolumns&nbsp;</p><p>&nbsp; WHERE (id = OBJECT_ID(@TableName))&nbsp;</p><p>&nbsp; declare @F1 varchar(100)&nbsp;</p><p>&nbsp; declare @F2 integer</p><p>&nbsp; declare @SQL varchar(8000)</p><p>&nbsp; set @sql =&#39;SELECT &#39;&#39;INSERT INTO &#39; + @TableName + &#39; VALUES(&#39;&#39;&#39;</p><p>&nbsp; OPEN xCursor&nbsp;</p><p>&nbsp; FETCH xCursor into @F1,@F2&nbsp;</p><p>&nbsp; WHILE @@FETCH_STATUS = 0&nbsp;</p><p>&nbsp; BEGIN</p><p>&nbsp; &nbsp; set @sql = @sql +&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; + case when @F2 IN (35,58,99,167,175,231,239,61) then &#39; + case when &#39; + @F1 + &#39; IS NULL then &#39;&#39;&#39;&#39; else &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39; end + &#39; &nbsp; else &#39;+&#39; end</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; + &#39;replace(ISNULL(cast(&#39; + @F1 + &#39; as varchar(8000)),&#39;&#39;NULL&#39;&#39;),&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;,&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;)&#39; &nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; + case when @F2 IN (35,58,99,167,175,231,239,61) then &#39; + case when &#39; + @F1 + &#39; IS NULL then &#39;&#39;&#39;&#39; else &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39; end + &#39; &nbsp; else &#39;+&#39; end</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; + char(13) + &#39;&#39;&#39;,&#39;&#39;&#39; &nbsp;</p><p>&nbsp; &nbsp; FETCH NEXT FROM xCursor into @F1,@F2&nbsp;</p><p>&nbsp; END</p><p>&nbsp; CLOSE xCursor&nbsp;</p><p>&nbsp; DEALLOCATE xCursor&nbsp;</p><p>&nbsp; set @sql = left(@sql,len(@sql) - 5) + &#39; + &#39;&#39;)&#39;&#39; FROM &#39; + @TableName&nbsp;</p><p>&nbsp; exec (@sql)&nbsp;</p><p>GO</p><p><br/></p><p>exec sys.sp_MS_marksystemobject &#39;usp_GenInsertSQL&#39;</p><p>go</p><p><br/></p>