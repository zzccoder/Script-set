<p></p><p>--===================================</p><p>--修改XML数据</p><p>--参考：http://www.cnblogs.com/youring2/archive/2008/11/27/1342288.html</p><p><br/></p><p>DECLARE @xmlDoc XML</p><p>set @xmlDoc=&#39;&lt;root&gt;</p><p>&nbsp;</p><p>&lt;book id=&quot;0001&quot;&gt;</p><p>&nbsp;</p><p>&lt;title&gt;C# Program&lt;/title&gt;</p><p>&nbsp;</p><p>&lt;author&gt;Jerry&lt;/author&gt;</p><p>&nbsp;</p><p>&lt;price&gt;50&lt;/price&gt;</p><p>&nbsp;</p><p>&lt;/book&gt;</p><p>&nbsp;</p><p>&lt;book id=&quot;0002&quot;&gt;</p><p>&nbsp;</p><p>&lt;title&gt;Java Program&lt;/title&gt;</p><p>&nbsp;</p><p>&lt;author&gt;Tom&lt;/author&gt;</p><p>&nbsp;</p><p>&lt;price&gt;49&lt;/price&gt;</p><p>&nbsp;</p><p>&lt;/book&gt;</p><p>&nbsp;</p><p>&lt;/root&gt;&#39;</p><p>&nbsp;</p><p>&nbsp;</p><p>SELECT @xmlDoc</p><p>&nbsp;</p><p>--====================================================</p><p>--查询节点</p><p>select @xmlDoc.query(&#39;/book/title&#39;)</p><p>&nbsp;</p><p>--====================================================</p><p>--查询节点值</p><p>select @xmlDoc.value(&#39;(/book/@id)[1]&#39;, &#39;nvarchar(max)&#39;)</p><p>select @xmlDoc.value(&#39;(/book/title)[1]&#39;, &#39;nvarchar(max)&#39;)</p><p>&nbsp;</p><p>&nbsp;</p><p>--====================================================</p><p>--更新节点</p><p>set @xmlDoc.modify(&#39;replace value of (/root/book[@id=0001]/price/text())[1] with &quot;100&quot;&#39;)</p><p>&nbsp;</p><p>SELECT @xmlDoc.query(&#39;/root/book[@id=0001]/price&#39;)</p><p>--====================================================</p><p>--删除节点</p><p>set @xmlDoc.modify(&#39;delete /root/book[@id=0002]&#39;)</p><p>--====================================================</p><p>--插入节点</p><p>set @xmlDoc.modify(&#39;insert &lt;isbn&gt;78-596-134&lt;/isbn&gt; before (/root/book[@id=0001]/price)[1]&#39;)</p><p>--====================================================</p><p>--添加属性</p><p>set @xmlDoc.modify(&#39;insert attribute date{&quot;2008-11-27&quot;} into (/root/book[@id=0001])[1]&#39;)</p><p>--====================================================</p><p>--删除属性</p><p>set @xmlDoc.modify(&#39;delete root/book[@id=&quot;0001&quot;]/@id&#39;)</p><p>--====================================================</p><p>--修改属性</p><p>set @xmlDoc.modify(&#39;replace value of (root/book[@id=&quot;0001&quot;]/@id)[1] with &quot;0005&quot;&#39;)</p><p><br/></p>