<p></p><p>--==============================================</p><p>--将指定的字符串拆分多行数据</p><p>--==============================================</p><p>CREATE FUNCTION dbo.ufn_SplitString</p><p>(</p><p>&nbsp; @SourceSql VARCHAR(MAX) ,</p><p>&nbsp; @StrSeprate VARCHAR(10)</p><p>)</p><p>RETURNS @temp TABLE (C1 VARCHAR(MAX) )</p><p>AS</p><p>BEGIN</p><p>&nbsp; &nbsp; DECLARE @i INT</p><p>&nbsp; &nbsp; SET @SourceSql = RTRIM(LTRIM(@SourceSql))</p><p>&nbsp; &nbsp; SET @i = CHARINDEX(@StrSeprate, @SourceSql)</p><p>&nbsp; &nbsp; WHILE @i &gt;= 1</p><p>&nbsp; &nbsp; &nbsp; &nbsp; BEGIN</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INSERT &nbsp;@temp</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; VALUES &nbsp;( LEFT(@SourceSql, @i - 1) )</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SET @SourceSql = SUBSTRING(@SourceSql, @i + 1,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;LEN(@SourceSql) - @i)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SET @i = CHARINDEX(@StrSeprate, @SourceSql)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; END</p><p>&nbsp; &nbsp; IF @SourceSql &lt;&gt; &#39;\&#39;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; INSERT &nbsp;@temp</p><p>&nbsp; &nbsp; &nbsp; &nbsp; VALUES &nbsp;( @SourceSql )</p><p>&nbsp; &nbsp; RETURN</p><p>END</p><p>GO</p><p>--=====================================================</p><p>--用法：</p><p>SELECT * FROM dbo.ufn_SplitString(&#39;ABDC,BDF,DEF,,&#39;,&#39;,&#39;)</p><p>--排除空字符串</p><p>SELECT * FROM dbo.ufn_SplitString(&#39;ABDC,BDF,DEF,,&#39;,&#39;,&#39;)</p><p>WHERE C1&lt;&gt;&#39;&#39;</p><p><br/></p>