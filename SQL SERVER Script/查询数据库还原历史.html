<p>--=================================================</p><p>--查询数据库还原历史</p><p>SELECT &nbsp;bus.server_name AS &#39;server&#39; ,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; rh.restore_date ,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; bus.database_name AS &#39;database&#39; ,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; CAST(bus.first_lsn AS VARCHAR(50)) asLSN_First ,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; CAST(bus.last_lsn AS VARCHAR(50)) asLSN_Last ,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; CASE rh.[restore_type]</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHEN &#39;D&#39; THEN &#39;Database&#39;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHEN &#39;F&#39; THEN &#39;File&#39;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHEN &#39;G&#39; THEN &#39;Filegroup&#39;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHEN &#39;I&#39; THEN &#39;Differential&#39;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHEN &#39;L&#39; THEN &#39;Log&#39;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHEN &#39;V&#39; THEN &#39;Verifyonly&#39;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; END ASrhType</p><p>FROM &nbsp; &nbsp;msdb.dbo.backupset bus</p><p>&nbsp; &nbsp; &nbsp; &nbsp; INNER JOIN msdb.dbo.restorehistory rh&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ON rh.backup_set_id = bus.backup_set_id</p><p><br/></p>