<p>--=====================================</p><p>--开启CMDShell</p><p>SP_CONFIGURE &#39;show advanced options&#39;,1</p><p>GO</p><p>RECONFIGURE</p><p>GO</p><p><br/></p><p>SP_CONFIGURE &#39;xp_cmdshell&#39;,1</p><p>GO</p><p>RECONFIGURE</p><p>GO</p><p>--===================================================</p><p>--SQL Server获取OS日志：</p><p>declare @start_date varchar(21),</p><p>&nbsp; &nbsp; &nbsp;@end_date varchar(21),</p><p>&nbsp; &nbsp; &nbsp;@out_server varchar(50),</p><p>&nbsp; &nbsp; &nbsp;@cmd varchar(200)</p><p>select @start_date=&#39;12/31/2012,11:59:59PM&#39;,</p><p>&nbsp; &nbsp; &nbsp; @end_date=&#39;04/11/2013,11:59:59PM&#39;,</p><p>&nbsp; &nbsp; &nbsp; @out_server=&#39;ebj2454&#39;</p><p>select @start_date,@end_date</p><p>select @cmd=&#39;cscript c:\windows\system32\eventquery.vbs</p><p>&nbsp; &nbsp; &nbsp;/FI &quot;Datetime eq &#39;+@start_date+&#39;-&#39;+@end_date+&#39;&quot;</p><p>&nbsp; &nbsp; &nbsp;/FI &quot;Type eq Warning&quot; /L system /V &#39;+N&#39; -S &#39;+</p><p>&nbsp; &nbsp; &nbsp;@out_server &nbsp;</p><p>exec xp_cmdshell &nbsp;@cmd</p><p><br/></p><p>SELECT * FROM SYS.configurations</p><p><br/></p><p><br/></p>