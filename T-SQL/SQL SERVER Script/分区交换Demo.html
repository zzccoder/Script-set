<p></p><p>--现有数据表[dbo].[staging_TB1_20131018-104722]和分区表[dbo].[TB1]，需要将分区表和数据表中做数据交换</p><p>CREATE TABLE [dbo].[staging_TB1_20131018-104722](</p><p>&nbsp;[C1] [int] NOT NULL,</p><p>&nbsp;[C2] [nvarchar](200) NULL,</p><p>&nbsp;[C3] [nvarchar](200) NULL,</p><p>&nbsp;[PID] [bigint] NOT NULL</p><p>) ON [PRIMARY]</p><p>GO</p><p>ALTER TABLE [dbo].[staging_TB1_20131018-104722] &nbsp;WITH CHECK ADD &nbsp;CONSTRAINT [chk_staging_TB1_20131018-104722_partition_496] CHECK &nbsp;(([PID]&gt;N&#39;495000&#39; AND [PID]&lt;=N&#39;496000&#39;))</p><p>GO</p><p>ALTER TABLE [dbo].[staging_TB1_20131018-104722] CHECK CONSTRAINT [chk_staging_TB1_20131018-104722_partition_496]</p><p>GO</p><p>CREATE TABLE [dbo].[TB1](</p><p>&nbsp;[C1] [int] IDENTITY(1,1) NOT NULL,</p><p>&nbsp;[C2] [nvarchar](200) NULL,</p><p>&nbsp;[C3] [nvarchar](200) NULL,</p><p>&nbsp;[PID] [bigint] NOT NULL</p><p>)</p><p>GO</p><p>CREATE UNIQUE CLUSTERED INDEX [CI_PID_CI] ON [dbo].[TB1]&nbsp;</p><p>(</p><p>&nbsp;[C1] ASC,</p><p>&nbsp;[PID] ASC</p><p>)WITH (PAD_INDEX &nbsp;= OFF, STATISTICS_NORECOMPUTE &nbsp;= OFF,&nbsp;</p><p>SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF,&nbsp;</p><p>ONLINE = OFF, ALLOW_ROW_LOCKS &nbsp;= ON, ALLOW_PAGE_LOCKS &nbsp;= ON)</p><p>ON pf_Test([C1])</p><p>GO</p><p>------------------------------------------------------------------------------------------------------------------------------------------------------</p><p>查找分区表的对应的分区ID</p><p>SELECT $PARTITION.pf_Test(496000)</p><p>&nbsp;</p><p>将数据表数据导入到分区表中</p><p>ALTER TABLE [dbo].[staging_TB1_20131018-104722]</p><p>SWITCH TO [dbo].[TB1] PARTITION 496</p><p>&nbsp;</p><p>将分区表中数据导入到数据表</p><p>ALTER TABLE [dbo].[TB1]</p><p>SWITCH PARTITION 496 TO [dbo].[staging_TB1_20131018-104722]</p>