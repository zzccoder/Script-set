<p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">&nbsp;</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">--==========================================</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">--查看索引的使用情况</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">--索引在重建或删除新建时sys.dm_db_index_usage_stats中相关的数据会被清除</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">--索引在重整是不会清除sys.dm_db_index_usage_stats的数据</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">SELECT&nbsp;</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">DB_NAME(ixu.database_id)
DataBase_Name,</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">OBJECT_NAME(ixu.object_id)
Table_Name,</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">ix.name Index_Name ,</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">(</span></p><p style=";;font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">SELECT
MAX(s.rows)</span></p><p style=";;font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">FROM&nbsp;&nbsp; sysindexes s</span></p><p style=";;font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">WHERE&nbsp; s.id = ixu.object_id</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">) AS Table_Rows ,</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">STATS_DATE(ixu.object_id,
ixu.index_id) AS statistic_time,</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">ixu.user_updates,</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span lang="zh-CN" style="font-size: 18px;">ixu.last_user_update,</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">ixu.last_user_seek,</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">ixu.user_seeks,</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">ixu.last_user_scan,</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">ixu.user_scans,</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">ixu.last_user_lookup,</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">ixu.user_lookups,</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">ixu.user_updates/(ISNULL(ixu.user_seeks,0)</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">+ISNULL(ixu.user_scans,0)+1)
AS UseRate</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">FROM
sys.dm_db_index_usage_stats ixu</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">INNER JOIN
sys.indexes ix</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">ON ixu.object_id =
ix.object_id</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">AND ixu.index_id =
ix.index_id</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">INNER JOIN
sys.objects ob</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">ON ixu.object_id =
ob.object_id</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">WHERE&nbsp;&nbsp; ob.type = &#39;U&#39;</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">AND ob.is_ms_shipped
= 0</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">AND
ixu.database_id=DB_ID()</span></p><p style=";font-family:Calibri;font-size:10.5pt"><span style="font-size: 18px;">--AND
ix.object_id=OBJECT_ID(&#39;TableName&#39;)</span></p><p><br/></p>