<p>-----------------------------批量备份数据-------------------------------------------</p><p>Use master</p><p>GO</p><p>/*=================Usp_BackUp_DataBase========================</p><p>&nbsp; =====BackUp Sigle DataBase &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;======</p><p>&nbsp; =====Ken.Guo &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;======</p><p>&nbsp; =====2010.9.10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ======</p><p>&nbsp; =====Version: 2005 &amp; 2008 SQL Server &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;======</p><p>&nbsp; =====EXEC Usp_BackUp_DataBase &#39;MyDB&#39;,&#39;D:\BackUp&#39; &nbsp; &nbsp; &nbsp;======</p><p>&nbsp; ============================================================</p><p>*/</p><p>CREATE PROC &nbsp; [dbo].[Usp_BackUp_DataBase] @DatabaseName &nbsp; nvarchar(200),@Path &nbsp; nvarchar(200) &nbsp;&nbsp;</p><p>AS &nbsp;</p><p>&nbsp; BEGIN&nbsp;</p><p>&nbsp; DECLARE &nbsp; @fn &nbsp; varchar(200)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;,@sql &nbsp; varchar(1000) &nbsp;&nbsp;</p><p>&nbsp; SET &nbsp; @fn &nbsp; = &nbsp; @Path &nbsp; +(case &nbsp; when &nbsp; right(@Path,1) &nbsp; &lt;&gt;&#39;\&#39; &nbsp; then &nbsp; &#39;\&#39; &nbsp; else &nbsp; &#39;&#39; &nbsp; end) &nbsp;&nbsp;</p><p>&nbsp; +@DatabaseName+&#39;_&#39; &nbsp;&nbsp;</p><p>&nbsp; +convert(char(8),getdate(),112)+&#39;_&#39; &nbsp;&nbsp;</p><p>&nbsp;+replace(convert(char(8),getdate(),108),&#39;:&#39;,&#39;&#39;) &nbsp;&nbsp;</p><p>&nbsp; +&#39;.bak&#39; &nbsp;&nbsp;</p><p>&nbsp; set &nbsp; @sql &nbsp; = &nbsp; &#39;backup &nbsp; database &nbsp; &#39;+@DatabaseName &nbsp; + &nbsp; &#39; &nbsp; to &nbsp; disk &nbsp; = &nbsp; N&#39;&#39;&#39; &nbsp; + &nbsp; @fn &nbsp; + &nbsp; &#39;&#39;&#39;&#39; &nbsp;&nbsp;</p><p>&nbsp; --SELECT @sql&nbsp;</p><p>&nbsp; EXEC(@sql) &nbsp;</p><p>&nbsp; END</p><p><br/></p><p>GO</p><p><br/></p><p>Use master</p><p>GO</p><p>/*=============BackUp Mutile DataBase=========================*/</p><p>DECLARE @dbname nvarchar(200)</p><p>&nbsp; &nbsp; &nbsp; &nbsp;,@backup_path nvarchar(200)</p><p>SET @backup_path=&#39;D:\BackUp\&#39;</p><p>DECLARE db_info CURSOR&nbsp;</p><p>&nbsp; &nbsp; LOCAL&nbsp;</p><p>&nbsp; &nbsp; STATIC&nbsp;</p><p>&nbsp; &nbsp; READ_ONLY&nbsp;</p><p>&nbsp; &nbsp; FORWARD_ONLY&nbsp;</p><p>FOR --根据查询，添加其他筛选条件</p><p>&nbsp; SELECT&nbsp;</p><p>&nbsp; &nbsp; &nbsp; name&nbsp;</p><p>&nbsp; FROM master.sys.databases WITH(NOLOCK)&nbsp;</p><p>&nbsp; WHERE&nbsp;</p><p>&nbsp; &nbsp; &nbsp; database_id&gt;4</p><p><br/></p><p>OPEN db_info</p><p>FETCH NEXT FROM db_info INTO @dbname</p><p><br/></p><p>WHILE @@FETCH_STATUS=0</p><p>&nbsp;begin</p><p>&nbsp; EXEC master.dbo.Usp_BackUp_DataBase @dbname,@backup_path</p><p>&nbsp; FETCH NEXT FROM db_info INTO @dbname</p><p>&nbsp;END</p><p>close db_info</p><p>deallocate db_info</p><p><br/></p><p>---------------------------------BackUp DataBase End------------------------------------</p><p><br/></p>