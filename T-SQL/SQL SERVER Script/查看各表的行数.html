<p>--======================================</p><p>--查看各表的行数</p><p>--is_ms_shipped=0代表用户创建的表</p><p>--(I.indid=1 OR I.indid=0)代表聚簇索引和堆表</p><p>SELECT T.name AS TableName,</p><p>I.rows AS RowsCount,</p><p>(I.dpages*8/1024) AS DataSpaceMB,</p><p>((I.used-I.dpages)*8/1024) AS IndexSpaceMB,</p><p>(I.used*8/1024) AS TotalSpaceMB</p><p>FROM sys.sysindexes I</p><p>INNER JOIN sys.tables T</p><p>ON I.id=T.object_id</p><p>and (I.indid=1 OR I.indid=0)</p><p>AND T.is_ms_shipped=0</p><p>&nbsp;</p><p>&nbsp;</p><p>--======================================</p><p>--使用EXEC sys.sp_spaceused @tbname来获取表的大小和行数</p><p>IF(OBJECT_ID(&#39;tempdb.dbo.#tablespaceinfo&#39;) IS NOT NULL)</p><p>BEGIN</p><p>DROP TABLE #tablespaceinfo</p><p>PRINT &#39;DROP TABLE #tablespaceinfo&#39;</p><p>END</p><p>CREATE TABLE #tablespaceinfo</p><p>(</p><p>&nbsp; &nbsp;nameinfo VARCHAR(50),</p><p>&nbsp; &nbsp;rowsinfo INT,</p><p>&nbsp; &nbsp;reserved VARCHAR(20),</p><p>&nbsp; &nbsp;datainfo VARCHAR(20),</p><p>&nbsp; &nbsp;index_size VARCHAR(20),</p><p>&nbsp; &nbsp;unused VARCHAR(20)</p><p>);</p><p>DECLARE @tablename VARCHAR(255); --表名称</p><p>DECLARE @cmdsql VARCHAR(500);</p><p>DECLARE Info_cursor CURSOR FOR</p><p>SELECT T.name</p><p>FROM sys.tables T</p><p>WHERE is_ms_shipped=0;</p><p>OPEN Info_cursor;</p><p>FETCH NEXT FROM Info_cursor</p><p>INTO @tablename;</p><p>WHILE (@@FETCH_STATUS = 0)</p><p>BEGIN</p><p>execute sp_executesql</p><p>N&#39;INSERT INTO #tablespaceinfo EXEC sys.sp_spaceused @tbname&#39;,</p><p>N&#39;@tbname varchar(255)&#39;,</p><p>@tbname = @tablename</p><p>FETCH NEXT FROM Info_cursor</p><p>INTO @tablename</p><p>END</p><p>CLOSE Info_cursor</p><p>DEALLOCATE Info_cursor</p><p>SELECT * FROM #tablespaceinfo</p><p>ORDER BY CAST(REPLACE(reserved,&#39;KB&#39;,&#39;&#39;) AS BIGINT) DESC</p><p>&nbsp;--======================================</p><p>--使用sys.dm_db_partition_stats查看各表的行数</p><p>SELECT &nbsp;OBJECT_NAME(P.object_id) ,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; SUM(rows) AS RowsCount</p><p>FROM &nbsp; &nbsp;SYS.PARTITIONS P</p><p>&nbsp; &nbsp; &nbsp; &nbsp; INNER JOIN SYS.TABLES TB&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ON TB.object_id = P.object_id</p><p>WHERE &nbsp; ( index_id = 0</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OR index_id = 1</p><p>&nbsp; &nbsp; &nbsp; &nbsp; )</p><p>&nbsp; &nbsp; &nbsp; &nbsp; AND TB.is_ms_shipped = 0</p><p>GROUP BY P.object_id</p><p>ORDER BY RowsCount DESC</p><p>&nbsp;--======================================</p><p>--使用sys.dm_db_index_physical_stats查看各表的行数</p><p>--dm_db_index_physical_stats会导致锁表，请谨慎使用。</p><p>&nbsp;</p><p>&nbsp;SELECT * FROM sys.dm_db_index_physical_stats</p><p>(DB_ID(N&#39;DB1&#39;), OBJECT_ID(N&#39;dbo.TB22&#39;), NULL, NULL , &#39;DETAILED&#39;);</p><p><br/></p>