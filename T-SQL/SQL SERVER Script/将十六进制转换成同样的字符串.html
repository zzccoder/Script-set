<p>--=============================================</p><p>--将十六进制转换成同样的字符串</p><p style="white-space: normal;">-- 来自http://guangrou.blog.51cto.com/404164/1040606</p><p style="white-space: normal;">--============================================== &nbsp;</p><p>IF OBJECT_ID (&#39;dbo.varbin2hexstr&#39;) IS NOT NULL&nbsp;</p><p>&nbsp; &nbsp; DROP FUNCTION dbo.varbin2hexstr &nbsp;</p><p>GO &nbsp;&nbsp;</p><p>CREATE FUNCTION varbin2hexstr</p><p>( &nbsp;</p><p><span class="Apple-tab-span" style="white-space:pre">	</span>@bin VARBINARY(8000) &nbsp;</p><p>)RETURNS VARCHAR(8000) &nbsp;</p><p>AS&nbsp;</p><p>BEGIN&nbsp;</p><p>&nbsp; &nbsp;DECLARE @re VARCHAR(8000),@i INT&nbsp;</p><p>&nbsp; &nbsp;SELECT @re=&#39;&#39;,@i=DATALENGTH(@bin) &nbsp;</p><p>&nbsp; WHILE @i&gt;0 &nbsp;</p><p>&nbsp; &nbsp; &nbsp; SELECT @re=SUBSTRING(&#39;0123456789ABCDEF&#39;,SUBSTRING(@bin,@i,1)/16+1,1) &nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+SUBSTRING(&#39;0123456789ABCDEF&#39;,SUBSTRING(@bin,@i,1)%16+1,1) &nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+@re &nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;,@i=@i-1 &nbsp;</p><p>-- return(&#39;0x&#39;+@re) &nbsp;</p><p>RETURN &#39;0X&#39;+@re &nbsp;</p><p>END&nbsp;</p><p>--=====================================</p><p>--Demo</p><p>DECLARE @T VARBINARY(200)</p><p>SET @T=0X12245</p><p><br/></p><p>DECLARE @T1 NVARCHAR(MAX)</p><p><br/></p><p>SELECT [DemoDB1].[dbo].[varbin2hexstr] (@T)</p><p>GO</p><p><br/></p><p><br/></p>